@using leaderboard.Client.Toolbox
@inherits LayoutComponentBase
@inject IAuthenticationService AuthService

<MudThemeProvider/>
<MudDialogProvider/>
<MudSnackbarProvider/>


<MudLayout>
    <MudAppBar Color="Color.Primary">
        <MudLink Color="Color.Default" Underline="Underline.None" Href="/" Typo="Typo.h4">Leaderboard</MudLink>
        @*Leaderboard*@
        <MudSpacer />
        <AuthorizeView>
            <Authorized>
                <div>
                    <MudAvatar Style="height:50px; width:50px; cursor:pointer"  Size="Size.Large" @onclick="@(e => isOpen = !isOpen)" Image="@($"https://cdn.discordapp.com/avatars/{AuthService.GetUserDiscordIdClaim(context)}/{AuthService.GetAvatarIdClaim(context)}.png")" />
                    <MudPopover AnchorOrigin="Origin.BottomLeft" Origin Open="@isOpen" Fixed="true">
                        <MudNavMenu>
                            <MudNavLink Href="/logout">Log out</MudNavLink>
                        </MudNavMenu>
                    </MudPopover>
                </div>
                
            </Authorized>
            <NotAuthorized>
                <MudButton Link="/login" StartIcon="@Icons.Material.Filled.Login" Color="Color.Inherit">Log In</MudButton>
            </NotAuthorized>
        </AuthorizeView>
    </MudAppBar>
    @*<MudDrawer Open="true">

    </MudDrawer>*@
    <MudMainContent>
        <MudContainer MaxWidth="MaxWidth.Large">
            @Body
        </MudContainer>
    </MudMainContent>
</MudLayout>
@code{
    bool isOpen = false;

    void ToggleOpen()
    {
        isOpen = !isOpen;
    }
}